{% extends 'base.html' %}
{% block title %}{{ event.title }} - SGEA{% endblock %}

{% block content %}
<div class="container" style="max-width: 700px; margin: 3rem auto;">
  <div class="card shadow-sm border-0">
    <div class="card-body">

      <!-- Banner do evento -->
      {% if event.banner %}
      <div style="text-align: center; margin-bottom: 1.5rem;">
        <img src="{{ event.banner.url }}" alt="Banner do evento"
             style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
      </div>
      {% endif %}

      <h2 class="text-ceub mb-3">ğŸ“Œ {{ event.title }}</h2>
      <p><strong>ğŸ“‚ Tipo:</strong> {{ event.get_event_type_display }}</p>
      <p><strong>ğŸ—“ Data:</strong> {{ event.start_date }} Ã s {{ event.start_time }}</p>
      <p><strong>ğŸ“ Local:</strong> {{ event.location }}</p>
      <p><strong>ğŸ‘¤ ResponsÃ¡vel:</strong> {{ event.organizer }}</p>

      {% if event.description %}
      <hr>
      <p>{{ event.description }}</p>
      {% endif %}

      <!-- Form de inscriÃ§Ã£o/cancelamento (apenas alunos/professores) -->
      {% if request.user.role != 'organizer' %}
      <form method="post" class="d-flex justify-content-center mt-3">
        {% csrf_token %}
        {% if registered %}
          <button type="submit" name="unsubscribe" class="btn btn-danger me-2">âŒ Cancelar inscriÃ§Ã£o</button>
        {% else %}
          <button type="submit" name="subscribe" class="btn btn-primary me-2">âœ… Inscrever-se</button>
        {% endif %}
        <a href="{% url 'core:events' %}" class="btn btn-secondary">Voltar</a>
      </form>
      {% endif %}

      <!-- Lista de participantes (qualquer organizador) -->
      {% if is_organizer %}
      <hr class="my-4">
      <h3 class="text-ceub mb-3">ğŸ‘¥ Participantes</h3>
      <div class="list-group">
        {% for participant in participants %}
        <div class="list-group-item d-flex justify-content-between align-items-center">
          <span>{{ participant.get_full_name|default:participant.username }}</span>
          <a href="{% url 'core:emitir_certificado' event.id participant.id %}" 
             class="btn btn-ceub btn-sm">ğŸ“ Emitir Certificado</a>
        </div>
        {% empty %}
        <div class="list-group-item">Nenhum participante inscrito ainda.</div>
        {% endfor %}
      </div>
      {% endif %}

    </div>
  </div>
</div>
{% endblock %}
